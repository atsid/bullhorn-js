define("bullhorn/Channel",[],function(){return function(){this.publish=function(e,t){throw new Error("Not Implemented")},this.subscribe=function(e,t,n){throw new Error("Not Implemented")},this.subscribeOnce=function(e,t,n){throw new Error("Not Implemented")},this.unsubscribe=function(){throw new Error("Not Implemented")}}}),define("bullhorn/Logger",[],function(){return function(e,t,n){var r={TRACE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5},i,s=[];e=r[e.toUpperCase()],t||(t=console),typeof n=="undefined"&&(n=""),i=function(e,r,i,o,u){var a=t[e]||t.info;r=n+r;if(o)i?a.call(t,r+" --> "+JSON.stringify(i)):a.call(t,r);else try{u[0]&&(u[0]=n+u[0]),a.apply(t,u)}catch(f){a(r,i,o,u)}s.forEach(function(t){t.log(e,r,i,o)})},this.addPlugin=function(e){s.push(e)},this.trace=function(t,n,s){e<=r.TRACE&&i("debug",t,n,s,arguments)},this.debug=function(t,n,s){e<=r.DEBUG&&i("debug",t,n,s,arguments)},this.info=function(t,n,s){e<=r.INFO&&i("info",t,n,s,arguments)},this.warn=function(t,n,s){e<=r.WARN&&i("warn",t,n,s,arguments)},this.error=function(t,n,s){e<=r.ERROR&&i("error",t,n,s,arguments)},this.time=function(e){t.time.apply(t,arguments)},this.timeEnd=function(e){t.timeEnd.apply(t,arguments)}}}),define("bullhorn/Validator",[],function(){return function(){this.validate=function(e,t,n,r){return!0}}}),define("bullhorn/CoreApi",["./Logger","./Validator"],function(e,t){var n=new e("info"),r=new t;return function(e){var t={busHash:{},setMessageBus:function(e,t){this.busHash[e]=t},getMessageBus:function(e){var t=this.busHash[e];return t||(t={},this.setMessageBus(e,t)),t},setCallbacks:function(e,t,n){this.getMessageBus(e)[t]=n},getCallbacks:function(e,t){var n=this.getMessageBus(e)[t];return n||(n=[],this.setCallbacks(e,t,n)),n},cropCallbacks:function(e,t,n){var r=this.getCallbacks(e,t);r=r.filter(function(e,t,r){return n(e)}),this.setCallbacks(e,t,r)},unsubscribe:function(e,t,n){this.cropCallbacks(e,t,function(e){return e.cs!==n})}};this.config=e,this.validatingPublish=function(e,t,i,s,o){var u=this.config.resolve(t);n.info("Validating message: "+i+" for channel: "+t),r.validate(i,u,!1),this.nonValidatingPublish(e,t,i,s,o)},this.nonValidatingPublish=function(e,r,i,s,o){var u=t.getCallbacks(e,r);u.some(function(s,u,a){var f=!0,l;n.info("Checking message: "+i+" for callback with scope: "+s.cs+"..."),typeof s.fp=="function"&&(f=s.fp.call(s.cs,i));if(f&&(s.cs!==o||s.csp===!0))return n.info("Message passed filter and scope checks. Publishing now..."),l=s.fn.call(s.cs,i),typeof l!="boolean"&&(l=!1),s.uah===!0&&(n.info("unsubscribeAfterHandle was true so unsubscribing now..."),t.unsubscribe(e,r,s.cs)),l}),typeof s=="function"&&(n.info("Calling completionCallback now..."),s.call(o))},this.publish=this.nonValidatingPublish,this.subscribe=function(e,r,i,s,o,u,a){var f=t.getCallbacks(e,r);n.info("Subscribing a new function to channel: "+r+" on bus: "+e),f.push({fn:i,fp:o,cs:s,csp:u,uah:a})},this.unsubscribe=function(e,r,i){n.info("Unsubscribing the object with scope: "+i+" from channel: "+r+" on bus: "+e),t.unsubscribe(e,r,i)},this.isValidating=function(){return this.publish===this.validatingPublish},this.validate=function(e){e===!0?(n.info("Turning schema validation on"),this.publish=this.validatingPublish):(n.info("Turning schema validation off"),this.publish=this.nonValidatingPublish)}}}),define("bullhorn/ChannelFactory",["./Channel","./CoreApi","./Logger"],function(e,t,n){var r=new n("info");return function(n){var i=[n.resolver],s=function(e,t,n,r,i){e.schema=t,e.publish=function(t,s){r.coreapi.publish(i,e.channelName,t,s,n)},e.unsubscribe=function(){r.coreapi.unsubscribe(i,e.channelName,n)},e.subscribe=function(t,s,o){r.coreapi.subscribe(i,e.channelName,t,n,s,o)},e.subscribeOnce=function(t,s,o){r.coreapi.subscribe(i,e.channelName,t,n,s,o,!0)}};this.resolveSchema=function(e){var t;return i.some(function(n){return t=n(e),t},this),t},this.coreapi=new t({resolve:this.resolveSchema}),this.addResolver=function(e){i.push(e)},this.get=function(t,n,i){var o,u;return typeof i=="undefined"&&(i="global"),r.info("Getting channel "+t+" on bus "+i+" with scope "+n),o=this.resolveSchema(t),u=new e,u.channelName=t,s(u,o,n,this,i),u},this.validate=function(e){var t="off";e&&(t="on"),r.info("Turning validation "+t),this.coreapi.validate(e)}}});